class hive:
	data_quanlity = (
		'''SELECT '''
		'''  --SCPR GA Users from google analysis \n'''
		'''  '' AS GA_Users, '''
		'''  --MIP KPCC GTM Users \n'''
		'''  EXACT_COUNT_DISTINCT(cid) AS MIP_Users, '''
		'''  --(MIP KPCC GTM Users - SCPR GA Users ) / SCPR GA  Users \n'''
		'''  '' AS User_Variance, '''
		'''  --Identified e-mail newsletter subscribers \n'''
		'''  EXACT_COUNT_DISTINCT(IF(elq IS NOT NULL '''
		'''      AND NOT cd_index = 19 '''
		'''      AND NOT ea = 'Intent'  '''
		'''      AND NOT ec = 'Support', cid, NULL )) AS Identified_EmailSubscribers, '''
		'''  --Known e-mail newsletter subscribers \n'''
		'''  EXACT_COUNT_DISTINCT(IF(elq IS NOT NULL '''
		'''      AND NOT cd_index = 19 '''
		'''      AND NOT ea = 'Intent'  '''
		'''      AND NOT ec = 'Support', elq, NULL )) AS Known_EmailSubscribers, '''
		'''  --Total number of known e-mail newsletter subscribers in the MIP database \n'''
		'''  EXACT_COUNT_DISTINCT(IF(elq IS NOT NULL '''
		'''      AND NOT cd_index = 19 '''
		'''      AND NOT ea = 'Intent'  '''
		'''      AND NOT ec = 'Support', elq, NULL ))+ EXACT_COUNT_DISTINCT(IF(NOT cd_index = 20 '''
		'''      AND cd_index = 19 '''
		'''      AND ea = 'Intent'  '''
		'''      AND ec = 'Support', cid, NULL ))+ EXACT_COUNT_DISTINCT(IF( IF(NOT cd_index = 20 '''
		'''        AND (cd_index = 19 '''
		'''          OR elq IS NOT NULL) '''
		'''        AND NOT ea = 'Intent'  '''
		'''        AND NOT ec = 'Support', IF(elq IS NULL, cd19_value, elq), NULL ) = IF(NOT cd_index = 20 '''
		'''        AND cd_index = 19 '''
		'''        AND ea = 'Intent'  '''
		'''        AND ec = 'Support', IF(elq IS NULL, cd19_value, elq), NULL), IF(elq IS NULL, cd19_value, elq), NULL)) AS Total_Database_Emails, '''
		'''  --New identified e-mail newsletter subscribers \n'''
		'''  EXACT_COUNT_DISTINCT(IF(NOT cd_index = 20 '''
		'''      AND cd_index = 19 '''
		'''      AND NOT ea = 'Intent'  '''
		'''      AND NOT ec = 'Suppport', cid, NULL )) AS Identified_NewEmailSubscribers, '''
		'''  --E-mail newsletter clicks \n'''
		'''  SUM(IF(Hit_Type='PAGE'  '''
		'''      AND elqTrackId IS NOT NULL '''
		'''      AND elq IS NOT NULL, 1, NULL)) AS Email_Newsletter_Clicks, '''
		'''  --Eloqua e-mail newsletter clicks \n'''
		'''  '' AS Eloqua_Email_Newsletter_Clicks, '''
		'''  --e-mail newsletter clicks Variance \n'''
		'''  '' AS Email_Newsletter_Clicks_Variance, '''
		'''  --Identified donors \n'''
		'''  EXACT_COUNT_DISTINCT(IF( NOT cd_index = 20 '''
		'''      AND cd_index = 19 '''
		'''      AND ea = 'Intent'  '''
		'''      AND ec = 'Support', cid, NULL )) AS Identified_Donors, '''
		'''  --Known donors \n'''
		'''  EXACT_COUNT_DISTINCT(IF(NOT cd_index = 20 '''
		'''      AND cd_index = 19 '''
		'''      AND ea = 'Intent'  '''
		'''      AND ec = 'Support', cid, NULL )) AS Known_Donors, '''
		'''  --Eloqua known donors \n'''
		'''  '' AS Eloqua_Known_Donors, '''
		'''  --Variance \n'''
		'''  '' AS Donors_Variance, '''
		'''  --Total number of known donors in the MIP database \n'''
		'''  EXACT_COUNT_DISTINCT(IF(NOT cd_index = 20 '''
		'''      AND cd_index = 19 '''
		'''      AND ea = 'Intent'  '''
		'''      AND ec = 'Support', cid, NULL )) AS Total_Known_Donors, '''
		'''  --Total number of unique known e-mail addresses in the MIP database \n'''
		'''  '' AS Total_Known__Unique_Email '''
		'''FROM ( '''
		'''  SELECT '''
		'''    fullVisitorId AS cid, '''
		'''    hits.type AS Hit_Type, '''
		'''    REGEXP_EXTRACT(hits.page.pagePath, r'elq=(.+)elqat') AS elq, '''
		'''    REGEXP_EXTRACT(hits.page.pagePath, r'elqTrackId=(.+)elq=') AS elqTrackId, '''
		'''    REGEXP_EXTRACT(hits.page.pagePath, r'elqaid=(.+)elqTrackId') AS elqaid, '''
		'''    hits.customDimensions.index AS cd_index, '''
		'''    hits.eventInfo.eventCategory AS ec, '''
		'''    hits.eventInfo.eventAction AS ea, '''
		'''    IF(hits.customDimensions.index = 19, hits.customDimensions.value, NULL) AS cd19_value '''
		'''  FROM ( TABLE_DATE_RANGE([116430105.ga_sessions_], TIMESTAMP('{min_date}'), TIMESTAMP('{max_date}') )) ) ''')

class mysql:
	data_quanlity_daily = ('''INSERT INTO `daily_data_quanlity`( '''
		'''`date`,`events`,`ga_users`,`mip_users`,`user_variance`,`identified_emailsubscribers`,`known_emailsubscribers`, '''
		'''`total_database_emails`,`identified_newemailsubscribers`,`email_newsletter_clicks`,`eloqua_email_newsletter_clicks`,`email_newsletter_clicks_variance`, '''
		'''`identified_donors`,`known_donors`,`eloqua_known_donors`,`donors_variance`,`total_known_donors`,`total_known__unique_email`) '''
		'''VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s) ''')
	data_quanlity_weekly = ('''INSERT INTO `daily_data_quanlity`( '''
	'''`date`,`events`,`ga_users`,`mip_users`,`user_variance`,`identified_emailsubscribers`,`known_emailsubscribers`, '''
	'''`total_database_emails`,`identified_newemailsubscribers`,`email_newsletter_clicks`,`eloqua_email_newsletter_clicks`,`email_newsletter_clicks_variance`, '''
	'''`identified_donors`,`known_donors`,`eloqua_known_donors`,`donors_variance`,`total_known_donors`,`total_known__unique_email`) '''
	'''VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s) ''')
	data_quanlity_monthly = ('''INSERT INTO `daily_data_quanlity`( '''
	'''`date`,`events`,`ga_users`,`mip_users`,`user_variance`,`identified_emailsubscribers`,`known_emailsubscribers`, '''
	'''`total_database_emails`,`identified_newemailsubscribers`,`email_newsletter_clicks`,`eloqua_email_newsletter_clicks`,`email_newsletter_clicks_variance`, '''
	'''`identified_donors`,`known_donors`,`eloqua_known_donors`,`donors_variance`,`total_known_donors`,`total_known__unique_email`) '''
	'''VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s) ''')